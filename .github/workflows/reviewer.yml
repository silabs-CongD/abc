name: test

on:
  push:

permissions:
  contents: read
  pull-requests: write
  
jobs:
  sync:
    runs-on: ubuntu-latest
    steps:

      - name: test
        run: |
          pip3 install conan
          conan --version
          pip3 install cmake
          cmake --version

          git clone https://github.com/silabs-CongD/abc.git --branch=conan
          cd abc
          echo ==============================
          conan profile detect
          conan create . -s build_type=Release
          echo ==============================
          # conan list mycpplib/1.0:* --format=json
          echo ==============================
          conan cache path mycpplib/1.0
          
          echo 111==============================
          cd test_package
          conan install . --build=missing
          cmake . -DCMAKE_TOOLCHAIN_FILE=conan_toolchain.cmake
          cmake --build .
          ./test_package

      # - name: Do sync
      #   run: |
          
      #     curl -X POST \
      #       -H "Authorization: token ${{ secrets.GITHUB_TOKEN }}" \
      #       -H "Accept: application/vnd.github+json" \
      #       https://api.github.com/repos/silabs-CongD/abc/pulls/4/requested_reviewers \
      #       -d '{"reviewers": ["congneb"]}'
